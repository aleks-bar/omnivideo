!function(e){"function"==typeof define&&define.amd?define("omnivideo",e):e()}((function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function t(t,r){return function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,o,n,a,c=[],l=!0,s=!1;try{if(n=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=n.call(r)).done)&&(c.push(i.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,r)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".omnivideo-block").forEach((function(e){var r=e.querySelector(".omnivideo-poster"),i=e.getAttribute("data-default");if(e.querySelectorAll(".omnivideo-link[data-type]").forEach((function(r){r.addEventListener("click",(function(i){if(i.preventDefault(),!r.classList.contains("current")){e.querySelectorAll(".omnivideo-link").forEach((function(e){return e.classList.remove("current")})),r.classList.add("current"),e.classList.add("omnivideo-block--playing");var o=e.querySelector(".omnivideo-embed");e.querySelector(".omnivideo-embed-container").style.display="block",o.innerHTML='<div class="omnivideo-loader"></div>';var n=i.currentTarget.dataset,a=n.type,c=n.url;if("mp4"!==a&&"telegram"!==a){var l=document.createElement("iframe");switch(l.width="730",l.height="411",l.setAttribute("allow","autoplay; fullscreen; picture-in-picture; encrypted-media; gyroscope; accelerometer; clipboard-write; web-share"),l.setAttribute("frameborder","0"),l.setAttribute("allowfullscreen",""),l.setAttribute("referrerpolicy","strict-origin-when-cross-origin"),a){case"youtube":var s,u=c.includes("youtu.be")?c.split("youtu.be/")[1].split("?")[0]:null===(s=c.split("v=")[1])||void 0===s?void 0:s.split("&")[0];l.src="https://www.youtube.com/embed/".concat(u,"?autoplay=1&feature=oembed");break;case"vk":var d=t(c.split("video-")[1].split("_"),2),p=d[0],m=d[1];l.src="https://vk.com/video_ext.php?oid=-".concat(p,"&id=").concat(m,"&hd=2&autoplay=1");break;case"dzen":l.src=c;break;case"rutube":l.src="https://rutube.ru/play/embed/".concat(c.split("/video/")[1]);break;case"vimeo":var v=c.split(".com/")[1];l.src="https://player.vimeo.com/video/".concat(v,"?autoplay=1");break;case"ok":var f=c.split("/video/")[1];l.src="//ok.ru/videoembed/".concat(f);break;case"mailru":var b=c.split("embed/")[1];l.src="https://my.mail.ru/video/embed/".concat(b);break;case"kinescope":var y=c.split("/")[3];l.src="https://kinescope.io/embed/".concat(y)}o.innerHTML="",o.appendChild(l)}else if("mp4"===a){var h=document.createElement("video");h.setAttribute("controls","controls"),h.setAttribute("autoplay","autoplay"),h.setAttribute("width","100%"),h.innerHTML='<source src="'.concat(c,'" type="video/mp4">Your browser does not support the video tag.'),o.innerHTML="",o.appendChild(h)}else if("telegram"===a){var k=c.split("/").slice(-2).join("/"),g=document.createElement("script");g.async=!0,g.src="https://telegram.org/js/telegram-widget.js?22",g.setAttribute("data-telegram-post",k),g.setAttribute("data-width","100%"),o.innerHTML="",o.appendChild(g)}}}))})),r&&r.addEventListener("click",(function(){var t,r=e.querySelector('.omnivideo-link[data-type="'.concat(i,'"]'));r?r.click():null===(t=e.querySelector(".omnivideo-link[data-type]"))||void 0===t||t.click()})),i&&!r){var o=e.querySelector('.omnivideo-link[data-type="'.concat(i,'"]'));o&&(o.click(),o.classList.add("current"),e.classList.add("omnivideo-block--playing"))}})),document.querySelectorAll(".js-omnivideo-pseudo").forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault();var r=e.getAttribute("data-href")||e.getAttribute("href");if(r){var i=atob(r);"_blank"===(e.getAttribute("data-target")||e.getAttribute("target"))?window.open(i,"_blank").opener=null:window.location.href=i}}))}))}))}));